/**
 * Single File Cloudflare Worker - Base64 Image Converter
 * Generated by AI
 */

export default {
    async fetch(request, env, ctx) {
        const html = "<!DOCTYPE html>\n<html lang=\"zh-CN\">\n\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Base64 \u56fe\u50cf\u8f6c\u6362\u5668 - \u65e0\u635f\u8f6c\u6362\u5de5\u5177</title>\n    <meta name=\"description\" content=\"\u9ad8\u6027\u80fd Base64 \u56fe\u50cf\u65e0\u635f\u8f6c\u6362\u5de5\u5177\uff0c\u652f\u6301\u591a\u79cd\u683c\u5f0f\u63d0\u53d6\u3001\u62d6\u62fd\u4e0a\u4f20\u3001\u5927\u6587\u4ef6\u5904\u7406\">\n    <link rel=\"preconnect\" href=\"https://fonts.googleapis.com\">\n    <link rel=\"preconnect\" href=\"https://fonts.gstatic.com\" crossorigin>\n    <link href=\"https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap\"\n        rel=\"stylesheet\">\n    <style>\n/* ========================================\n   Base64 \u56fe\u50cf\u8f6c\u6362\u5668 - \u6837\u5f0f\u6587\u4ef6\n   \u73b0\u4ee3\u6df1\u8272\u4e3b\u9898 + \u6bdb\u73bb\u7483\u6548\u679c\n======================================== */\n\n/* CSS \u53d8\u91cf */\n:root {\n    /* \u4e3b\u8272\u8c03 */\n    --primary: #6366f1;\n    --primary-light: #818cf8;\n    --primary-dark: #4f46e5;\n    --primary-glow: rgba(99, 102, 241, 0.4);\n\n    /* \u5f3a\u8c03\u8272 */\n    --accent: #22d3ee;\n    --accent-light: #67e8f9;\n    --accent-glow: rgba(34, 211, 238, 0.3);\n\n    /* \u6210\u529f/\u8b66\u544a/\u9519\u8bef */\n    --success: #10b981;\n    --warning: #f59e0b;\n    --error: #ef4444;\n\n    /* \u80cc\u666f\u8272 */\n    --bg-primary: #0a0a0f;\n    --bg-secondary: #12121a;\n    --bg-tertiary: #1a1a24;\n    --bg-elevated: #22222e;\n\n    /* \u6587\u5b57\u8272 */\n    --text-primary: #f1f5f9;\n    --text-secondary: #94a3b8;\n    --text-muted: #64748b;\n\n    /* \u8fb9\u6846 */\n    --border-subtle: rgba(255, 255, 255, 0.06);\n    --border-default: rgba(255, 255, 255, 0.1);\n    --border-strong: rgba(255, 255, 255, 0.15);\n\n    /* \u6bdb\u73bb\u7483 */\n    --glass-bg: rgba(18, 18, 26, 0.7);\n    --glass-border: rgba(255, 255, 255, 0.08);\n\n    /* \u9634\u5f71 */\n    --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);\n    --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);\n    --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);\n    --shadow-glow: 0 0 40px var(--primary-glow);\n\n    /* \u52a8\u753b */\n    --transition-fast: 150ms ease;\n    --transition-normal: 250ms ease;\n    --transition-slow: 400ms ease;\n\n    /* \u5706\u89d2 */\n    --radius-sm: 6px;\n    --radius-md: 10px;\n    --radius-lg: 16px;\n    --radius-xl: 24px;\n}\n\n/* \u91cd\u7f6e\u6837\u5f0f */\n*,\n*::before,\n*::after {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nhtml {\n    font-size: 16px;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n}\n\nbody {\n    font-family: 'Noto Sans SC', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\n    background: var(--bg-primary);\n    color: var(--text-primary);\n    min-height: 100vh;\n    line-height: 1.6;\n    overflow-x: hidden;\n}\n\n/* \u80cc\u666f\u88c5\u9970 */\nbody::before {\n    content: '';\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background:\n        radial-gradient(ellipse 80% 50% at 20% 20%, rgba(99, 102, 241, 0.08), transparent),\n        radial-gradient(ellipse 60% 40% at 80% 80%, rgba(34, 211, 238, 0.06), transparent);\n    pointer-events: none;\n    z-index: 0;\n}\n\n/* \u5e94\u7528\u5bb9\u5668 */\n.app-container {\n    position: relative;\n    z-index: 1;\n    max-width: 1600px;\n    margin: 0 auto;\n    padding: 24px;\n    min-height: 100vh;\n    display: flex;\n    flex-direction: column;\n}\n\n/* ========================================\n   \u5934\u90e8\u6837\u5f0f\n======================================== */\n.app-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 16px 24px;\n    background: var(--glass-bg);\n    backdrop-filter: blur(20px);\n    border: 1px solid var(--glass-border);\n    border-radius: var(--radius-lg);\n    margin-bottom: 24px;\n}\n\n.logo {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.logo-icon {\n    width: 44px;\n    height: 44px;\n    background: linear-gradient(135deg, var(--primary), var(--accent));\n    border-radius: var(--radius-md);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    box-shadow: var(--shadow-glow);\n}\n\n.logo-icon svg {\n    width: 24px;\n    height: 24px;\n    color: white;\n}\n\n.logo h1 {\n    font-size: 1.5rem;\n    font-weight: 600;\n    background: linear-gradient(135deg, var(--text-primary), var(--text-secondary));\n    -webkit-background-clip: text;\n    -webkit-text-fill-color: transparent;\n    background-clip: text;\n}\n\n.header-badge {\n    display: flex;\n    gap: 8px;\n}\n\n.badge {\n    padding: 6px 14px;\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-default);\n    border-radius: 20px;\n    font-size: 0.8rem;\n    font-weight: 500;\n    color: var(--text-secondary);\n}\n\n.badge.accent {\n    background: linear-gradient(135deg, rgba(34, 211, 238, 0.15), rgba(99, 102, 241, 0.15));\n    border-color: rgba(34, 211, 238, 0.3);\n    color: var(--accent);\n}\n\n/* ========================================\n   \u6027\u80fd\u76d1\u63a7\u6761\n======================================== */\n.perf-banner {\n    display: flex;\n    justify-content: center;\n    gap: 32px;\n    padding: 12px;\n    background: rgba(16, 185, 129, 0.1);\n    border: 1px solid rgba(16, 185, 129, 0.2);\n    border-radius: var(--radius-md);\n    margin-bottom: 24px;\n    backdrop-filter: blur(10px);\n}\n\n.perf-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 0.9rem;\n    font-weight: 500;\n    color: var(--success);\n}\n\n.perf-icon {\n    font-size: 1.1rem;\n}\n\n/* ========================================\n   \u4e3b\u5185\u5bb9\u533a\n======================================== */\n.main-content {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 24px;\n    flex: 1;\n}\n\n/* \u6a21\u5f0f\u5207\u6362 */\n.mode-switcher {\n    display: flex;\n    background: var(--bg-tertiary);\n    padding: 4px;\n    border-radius: var(--radius-md);\n    margin-bottom: 12px;\n}\n\n.mode-tab {\n    flex: 1;\n    padding: 10px;\n    border: none;\n    background: transparent;\n    color: var(--text-secondary);\n    font-size: 0.9rem;\n    font-weight: 600;\n    cursor: pointer;\n    border-radius: var(--radius-sm);\n    transition: all var(--transition-fast);\n}\n\n.mode-tab.active {\n    background: var(--bg-elevated);\n    color: var(--primary-light);\n    box-shadow: var(--shadow-sm);\n}\n\n/* \u8f93\u5165\u533a */\n.input-section {\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n}\n\n/* \u62d6\u62fd\u533a\u57df */\n.drop-zone {\n    position: relative;\n    padding: 48px 32px;\n    background: var(--glass-bg);\n    backdrop-filter: blur(20px);\n    border: 2px dashed var(--border-strong);\n    border-radius: var(--radius-lg);\n    text-align: center;\n    cursor: pointer;\n    transition: all var(--transition-normal);\n    overflow: hidden;\n}\n\n.drop-zone::before {\n    content: '';\n    position: absolute;\n    inset: 0;\n    background: linear-gradient(135deg, var(--primary-glow), transparent);\n    opacity: 0;\n    transition: opacity var(--transition-normal);\n}\n\n.drop-zone:hover,\n.drop-zone.drag-over {\n    border-color: var(--primary);\n    background: rgba(99, 102, 241, 0.05);\n}\n\n.drop-zone:hover::before,\n.drop-zone.drag-over::before {\n    opacity: 1;\n}\n\n.drop-zone-content {\n    position: relative;\n    z-index: 1;\n}\n\n.drop-icon {\n    width: 64px;\n    height: 64px;\n    margin: 0 auto 16px;\n    background: var(--bg-tertiary);\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: transform var(--transition-normal);\n}\n\n.drop-zone:hover .drop-icon {\n    transform: translateY(-4px);\n}\n\n.drop-icon svg {\n    width: 32px;\n    height: 32px;\n    color: var(--primary);\n}\n\n.drop-zone h3 {\n    font-size: 1.2rem;\n    font-weight: 600;\n    margin-bottom: 8px;\n    color: var(--text-primary);\n}\n\n.drop-zone p {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n    margin-bottom: 4px;\n}\n\n.drop-zone .hint {\n    font-size: 0.85rem;\n    color: var(--text-muted);\n}\n\n/* \u5206\u9694\u7ebf */\n.divider {\n    display: flex;\n    align-items: center;\n    gap: 16px;\n    color: var(--text-muted);\n    font-size: 0.85rem;\n}\n\n.divider::before,\n.divider::after {\n    content: '';\n    flex: 1;\n    height: 1px;\n    background: var(--border-subtle);\n}\n\n/* \u6587\u672c\u8f93\u5165\u533a */\n.input-wrapper {\n    position: relative;\n    flex: 1;\n    min-height: 200px;\n}\n\n.copy-btn {\n    position: absolute;\n    top: 12px;\n    right: 12px;\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 14px;\n    background: var(--glass-bg);\n    border: 1px solid var(--border-default);\n    border-radius: var(--radius-sm);\n    color: var(--text-secondary);\n    font-size: 0.8rem;\n    cursor: pointer;\n    backdrop-filter: blur(10px);\n    transition: all var(--transition-fast);\n    z-index: 10;\n}\n\n.copy-btn:hover {\n    background: var(--primary);\n    border-color: var(--primary);\n    color: white;\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px var(--primary-glow);\n}\n\n.copy-btn svg {\n    width: 14px;\n    height: 14px;\n}\n\n.code-input {\n    width: 100%;\n    height: 100%;\n    min-height: 200px;\n    padding: 16px;\n    background: var(--glass-bg);\n    backdrop-filter: blur(20px);\n    border: 1px solid var(--border-default);\n    border-radius: var(--radius-lg);\n    color: var(--text-primary);\n    font-family: 'JetBrains Mono', 'Fira Code', Consolas, monospace;\n    font-size: 0.9rem;\n    line-height: 1.6;\n    resize: none;\n    transition: border-color var(--transition-fast);\n}\n\n.code-input::placeholder {\n    color: var(--text-muted);\n}\n\n.code-input:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\n.input-stats {\n    position: absolute;\n    bottom: 12px;\n    right: 12px;\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.input-stats span {\n    font-size: 0.8rem;\n    color: var(--text-muted);\n}\n\n.example-group {\n    position: relative;\n}\n\n.example-btn {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 12px;\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(34, 211, 238, 0.1));\n    border: 1px solid var(--border-default);\n    border-radius: var(--radius-sm);\n    color: var(--accent);\n    font-size: 0.8rem;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all var(--transition-fast);\n}\n\n.example-btn:hover {\n    background: linear-gradient(135deg, rgba(99, 102, 241, 0.2), rgba(34, 211, 238, 0.2));\n    border-color: var(--accent);\n    transform: translateY(-1px);\n    box-shadow: 0 4px 12px var(--accent-glow);\n}\n\n.example-btn svg {\n    width: 14px;\n    height: 14px;\n}\n\n.example-dropdown {\n    position: absolute;\n    bottom: calc(100% + 8px);\n    right: 0;\n    width: 180px;\n    background: var(--bg-elevated);\n    border: 1px solid var(--border-strong);\n    border-radius: var(--radius-md);\n    padding: 8px;\n    box-shadow: var(--shadow-lg);\n    display: none;\n    flex-direction: column;\n    gap: 4px;\n    z-index: 100;\n}\n\n.example-dropdown.show {\n    display: flex;\n    animation: slideUp 0.2s ease;\n}\n\n@keyframes slideUp {\n    from {\n        opacity: 0;\n        transform: translateY(10px);\n    }\n\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.example-dropdown button {\n    padding: 10px 12px;\n    background: transparent;\n    border: none;\n    color: var(--text-secondary);\n    text-align: left;\n    font-size: 0.85rem;\n    cursor: pointer;\n    border-radius: var(--radius-sm);\n    transition: all var(--transition-fast);\n}\n\n.example-dropdown button:hover {\n    background: var(--primary-glow);\n    color: var(--text-primary);\n}\n\n.clear-btn {\n    width: 28px;\n    height: 28px;\n    padding: 0;\n    background: var(--bg-tertiary);\n    border: 1px solid var(--border-subtle);\n    border-radius: var(--radius-sm);\n    color: var(--text-muted);\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all var(--transition-fast);\n}\n\n.clear-btn:hover {\n    background: var(--error);\n    border-color: var(--error);\n    color: white;\n}\n\n.clear-btn svg {\n    width: 14px;\n    height: 14px;\n}\n\n/* \u8f6c\u6362\u6309\u94ae */\n.convert-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 10px;\n    padding: 16px 32px;\n    background: linear-gradient(135deg, var(--primary), var(--primary-dark));\n    border: none;\n    border-radius: var(--radius-md);\n    color: white;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all var(--transition-normal);\n    box-shadow: var(--shadow-md), 0 0 20px var(--primary-glow);\n}\n\n.convert-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg), 0 0 30px var(--primary-glow);\n}\n\n.convert-btn:active {\n    transform: translateY(0);\n}\n\n.convert-btn:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.convert-btn.spinning svg {\n    animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n    from {\n        transform: rotate(0deg);\n    }\n\n    to {\n        transform: rotate(360deg);\n    }\n}\n\n.convert-btn svg {\n    width: 20px;\n    height: 20px;\n}\n\n/* \u8fdb\u5ea6\u6761 */\n.progress-container {\n    display: none;\n    padding: 16px;\n    background: var(--glass-bg);\n    backdrop-filter: blur(20px);\n    border: 1px solid var(--border-default);\n    border-radius: var(--radius-md);\n}\n\n.progress-container.show {\n    display: block;\n    animation: fadeIn 0.3s ease;\n}\n\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(-10px);\n    }\n\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.progress-header {\n    display: flex;\n    justify-content: space-between;\n    margin-bottom: 10px;\n}\n\n.progress-label {\n    font-size: 0.9rem;\n    color: var(--text-secondary);\n}\n\n.progress-percent {\n    font-size: 0.9rem;\n    font-weight: 600;\n    color: var(--primary-light);\n}\n\n.progress-bar {\n    height: 6px;\n    background: var(--bg-tertiary);\n    border-radius: 3px;\n    overflow: hidden;\n}\n\n.progress-fill {\n    height: 100%;\n    width: 0%;\n    background: linear-gradient(90deg, var(--primary), var(--accent));\n    border-radius: 3px;\n    transition: width 0.3s ease;\n    position: relative;\n}\n\n.progress-fill::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);\n    animation: shimmer 1.5s infinite;\n}\n\n@keyframes shimmer {\n    from {\n        transform: translateX(-100%);\n    }\n\n    to {\n        transform: translateX(100%);\n    }\n}\n\n/* ========================================\n   \u9884\u89c8\u533a\u6837\u5f0f\n======================================== */\n.preview-section {\n    display: flex;\n    flex-direction: column;\n    gap: 16px;\n    background: var(--glass-bg);\n    backdrop-filter: blur(20px);\n    border: 1px solid var(--glass-border);\n    border-radius: var(--radius-lg);\n    padding: 24px;\n    min-height: 500px;\n}\n\n/* \u7a7a\u72b6\u6001 */\n.empty-state {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    text-align: center;\n    padding: 48px;\n}\n\n.empty-icon {\n    width: 100px;\n    height: 100px;\n    margin-bottom: 24px;\n    color: var(--text-muted);\n    opacity: 0.4;\n}\n\n.empty-icon svg {\n    width: 100%;\n    height: 100%;\n}\n\n.empty-state h3 {\n    font-size: 1.3rem;\n    font-weight: 600;\n    color: var(--text-secondary);\n    margin-bottom: 8px;\n}\n\n.empty-state p {\n    font-size: 0.95rem;\n    color: var(--text-muted);\n}\n\n/* \u56fe\u50cf\u9884\u89c8 */\n.preview-wrapper {\n    flex: 1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n}\n\n.preview-canvas-container {\n    position: relative;\n    max-width: 100%;\n    max-height: 400px;\n    border-radius: var(--radius-md);\n    overflow: hidden;\n    box-shadow: var(--shadow-lg);\n}\n\n.preview-image {\n    max-width: 100%;\n    max-height: 400px;\n    object-fit: contain;\n    display: block;\n    background: repeating-conic-gradient(#1a1a24 0% 25%, #22222e 0% 50%) 50% / 20px 20px;\n}\n\n.image-overlay {\n    position: absolute;\n    top: 12px;\n    right: 12px;\n    display: flex;\n    gap: 8px;\n    opacity: 0;\n    transition: opacity var(--transition-fast);\n}\n\n.preview-canvas-container:hover .image-overlay {\n    opacity: 1;\n}\n\n.overlay-btn {\n    width: 36px;\n    height: 36px;\n    padding: 0;\n    background: rgba(0, 0, 0, 0.6);\n    backdrop-filter: blur(10px);\n    border: 1px solid var(--border-subtle);\n    border-radius: var(--radius-sm);\n    color: white;\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all var(--transition-fast);\n}\n\n.overlay-btn:hover {\n    background: var(--primary);\n    border-color: var(--primary);\n}\n\n.overlay-btn svg {\n    width: 18px;\n    height: 18px;\n}\n\n/* \u4fe1\u606f\u9762\u677f */\n.info-panel {\n    padding: 20px;\n    background: var(--bg-tertiary);\n    border-radius: var(--radius-md);\n}\n\n.info-panel h4 {\n    font-size: 0.9rem;\n    font-weight: 600;\n    color: var(--text-secondary);\n    margin-bottom: 16px;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.info-grid {\n    display: grid;\n    grid-template-columns: repeat(2, 1fr);\n    gap: 16px;\n    margin-bottom: 20px;\n}\n\n.info-item {\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n}\n\n.info-label {\n    font-size: 0.8rem;\n    color: var(--text-muted);\n}\n\n.info-value {\n    font-size: 1rem;\n    font-weight: 600;\n    color: var(--text-primary);\n}\n\n/* \u4e0b\u8f7d\u533a\u57df */\n.download-section {\n    margin-top: 8px;\n}\n\n/* \u683c\u5f0f\u9009\u62e9\u5668 */\n.format-selector {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n    margin-bottom: 12px;\n}\n\n.format-label {\n    font-size: 0.85rem;\n    font-weight: 500;\n    color: var(--text-secondary);\n}\n\n.format-select {\n    width: 100%;\n    padding: 12px 16px;\n    background: var(--bg-elevated);\n    border: 1px solid var(--border-default);\n    border-radius: var(--radius-md);\n    color: var(--text-primary);\n    font-size: 0.95rem;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all var(--transition-fast);\n    appearance: none;\n    background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E\");\n    background-repeat: no-repeat;\n    background-position: right 12px center;\n    padding-right: 40px;\n}\n\n.format-select:hover {\n    border-color: var(--primary);\n}\n\n.format-select:focus {\n    outline: none;\n    border-color: var(--primary);\n    box-shadow: 0 0 0 3px var(--primary-glow);\n}\n\n.format-select option {\n    background: var(--bg-secondary);\n    color: var(--text-primary);\n    padding: 12px;\n}\n\n/* \u683c\u5f0f\u8bf4\u660e */\n.format-info {\n    display: flex;\n    align-items: flex-start;\n    gap: 8px;\n    padding: 10px 12px;\n    background: rgba(99, 102, 241, 0.08);\n    border: 1px solid rgba(99, 102, 241, 0.2);\n    border-radius: var(--radius-sm);\n    margin-bottom: 16px;\n}\n\n.format-info-icon {\n    font-size: 0.9rem;\n    color: var(--primary-light);\n    flex-shrink: 0;\n}\n\n.format-info-text {\n    font-size: 0.8rem;\n    color: var(--text-secondary);\n    line-height: 1.5;\n}\n\n.format-info.warning {\n    background: rgba(245, 158, 11, 0.08);\n    border-color: rgba(245, 158, 11, 0.3);\n}\n\n.format-info.warning .format-info-icon {\n    color: var(--warning);\n}\n\n/* \u4e0b\u8f7d\u6309\u94ae */\n.download-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 10px;\n    width: 100%;\n    padding: 14px 24px;\n    background: linear-gradient(135deg, var(--success), #059669);\n    border: none;\n    border-radius: var(--radius-md);\n    color: white;\n    font-size: 1rem;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all var(--transition-normal);\n    box-shadow: var(--shadow-md);\n}\n\n.download-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: var(--shadow-lg), 0 0 20px rgba(16, 185, 129, 0.4);\n}\n\n.download-btn:active {\n    transform: translateY(0);\n}\n\n.download-btn svg {\n    width: 20px;\n    height: 20px;\n}\n\n/* ========================================\n   Toast \u63d0\u793a\n======================================== */\n.toast {\n    position: fixed;\n    bottom: 32px;\n    left: 50%;\n    transform: translateX(-50%) translateY(100px);\n    padding: 14px 24px;\n    background: var(--bg-elevated);\n    backdrop-filter: blur(20px);\n    border: 1px solid var(--border-default);\n    border-radius: var(--radius-md);\n    box-shadow: var(--shadow-lg);\n    opacity: 0;\n    visibility: hidden;\n    transition: all var(--transition-normal);\n    z-index: 1000;\n}\n\n.toast.show {\n    transform: translateX(-50%) translateY(0);\n    opacity: 1;\n    visibility: visible;\n}\n\n.toast.error {\n    border-color: var(--error);\n    background: rgba(239, 68, 68, 0.15);\n}\n\n.toast.success {\n    border-color: var(--success);\n    background: rgba(16, 185, 129, 0.15);\n}\n\n.toast-message {\n    font-size: 0.95rem;\n    color: var(--text-primary);\n}\n\n/* ========================================\n   \u653e\u5927\u5f39\u7a97\n======================================== */\n.modal {\n    position: fixed;\n    inset: 0;\n    z-index: 2000;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    padding: 32px;\n    opacity: 0;\n    visibility: hidden;\n    transition: all var(--transition-normal);\n}\n\n.modal.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n.modal-backdrop {\n    position: absolute;\n    inset: 0;\n    background: rgba(0, 0, 0, 0.85);\n    backdrop-filter: blur(10px);\n}\n\n.modal-content {\n    position: relative;\n    max-width: 90vw;\n    max-height: 90vh;\n    z-index: 1;\n    transform: scale(0.9);\n    transition: transform var(--transition-normal);\n}\n\n.modal.show .modal-content {\n    transform: scale(1);\n}\n\n.modal-close {\n    position: absolute;\n    top: -16px;\n    right: -16px;\n    width: 40px;\n    height: 40px;\n    padding: 0;\n    background: var(--bg-elevated);\n    border: 1px solid var(--border-default);\n    border-radius: 50%;\n    color: var(--text-primary);\n    cursor: pointer;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    transition: all var(--transition-fast);\n    z-index: 2;\n}\n\n.modal-close:hover {\n    background: var(--error);\n    border-color: var(--error);\n}\n\n.modal-close svg {\n    width: 20px;\n    height: 20px;\n}\n\n.zoom-image {\n    max-width: 90vw;\n    max-height: 90vh;\n    object-fit: contain;\n    border-radius: var(--radius-md);\n    box-shadow: var(--shadow-lg);\n    background: repeating-conic-gradient(#1a1a24 0% 25%, #22222e 0% 50%) 50% / 20px 20px;\n}\n\n/* ========================================\n   \u54cd\u5e94\u5f0f\u9002\u914d\n======================================== */\n@media (max-width: 1024px) {\n    .main-content {\n        grid-template-columns: 1fr;\n    }\n\n    .preview-section {\n        min-height: 400px;\n    }\n}\n\n@media (max-width: 640px) {\n    .app-container {\n        padding: 16px;\n    }\n\n    .app-header {\n        flex-direction: column;\n        gap: 12px;\n        text-align: center;\n    }\n\n    .logo h1 {\n        font-size: 1.25rem;\n    }\n\n    .drop-zone {\n        padding: 32px 16px;\n    }\n\n    .info-grid {\n        grid-template-columns: 1fr;\n    }\n}\n</style>\n</head>\n\n<body>\n    <div class=\"app-container\">\n        <!-- \u5934\u90e8 -->\n        <header class=\"app-header\">\n            <div class=\"logo\">\n                <div class=\"logo-icon\">\n                    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                        <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" />\n                        <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" />\n                        <path d=\"M21 15l-5-5L5 21\" />\n                    </svg>\n                </div>\n                <h1>Base64 \u56fe\u50cf\u8f6c\u6362\u5668</h1>\n            </div>\n            <div class=\"header-badge\">\n                <span class=\"badge\">\u65e0\u635f\u8f6c\u6362</span>\n                <span class=\"badge accent\">\u9ad8\u6027\u80fd</span>\n            </div>\n        </header>\n\n        <!-- \u6027\u80fd\u76d1\u63a7\u6761 -->\n        <div class=\"perf-banner\" id=\"perfBanner\" style=\"display: none;\">\n            <div class=\"perf-item\">\n                <span class=\"perf-icon\">\u26a1</span>\n                <span id=\"perfSize\">-</span>\n            </div>\n            <div class=\"perf-item\">\n                <span class=\"perf-icon\">\u23f1\ufe0f</span>\n                <span id=\"perfTime\">-</span>\n            </div>\n            <div class=\"perf-item\">\n                <span class=\"perf-icon\">\ud83d\ude80</span>\n                <span id=\"perfSpeed\">-</span>\n            </div>\n        </div>\n\n        <!-- \u4e3b\u5185\u5bb9\u533a -->\n        <main class=\"main-content\">\n            <!-- \u5de6\u4fa7\u8f93\u5165\u533a -->\n            <section class=\"input-section\" id=\"leftSection\">\n                <!-- \u6a21\u5f0f\u5207\u6362 -->\n                <div class=\"mode-switcher\">\n                    <button class=\"mode-tab active\" id=\"modeB2I\" data-mode=\"b2i\">Base64 \u2192 \u56fe\u50cf</button>\n                    <button class=\"mode-tab\" id=\"modeI2B\" data-mode=\"i2b\">\u56fe\u50cf \u2192 Base64</button>\n                </div>\n\n                <!-- \u62d6\u62fd\u4e0a\u4f20\u533a -->\n                <div class=\"drop-zone\" id=\"dropZone\">\n                    <div class=\"drop-zone-content\">\n                        <div class=\"drop-icon\">\n                            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n                                <polyline points=\"17 8 12 3 7 8\" />\n                                <line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\" />\n                            </svg>\n                        </div>\n                        <h3 id=\"dropTitle\">\u62d6\u62fd\u6587\u4ef6\u5230\u6b64\u5904</h3>\n                        <p id=\"dropDesc\">\u652f\u6301\u6587\u672c\u3001\u4ee3\u7801\u7b49\u5305\u542b Base64 \u7684\u6587\u4ef6</p>\n                        <p class=\"hint\">\u6216\u70b9\u51fb\u9009\u62e9\u6587\u4ef6</p>\n                    </div>\n                    <input type=\"file\" id=\"fileInput\" hidden>\n                </div>\n\n                <!-- \u5206\u9694\u7ebf -->\n                <div class=\"divider\">\n                    <span id=\"dividerText\">\u6216\u7c98\u8d34 Base64 \u4ee3\u7801</span>\n                </div>\n\n                <!-- \u6587\u672c\u8f93\u5165\u533a -->\n                <div class=\"input-wrapper\">\n                    <textarea id=\"base64Input\" class=\"code-input\" placeholder=\"\u5728\u6b64\u8f93\u5165\u5185\u5bb9...\" spellcheck=\"false\"></textarea>\n\n                    <!-- \u590d\u5236\u6309\u94ae -->\n                    <button class=\"copy-btn\" id=\"copyBtn\" title=\"\u590d\u5236\u5168\u90e8\u5185\u5bb9\">\n                        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                            <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\" />\n                            <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\" />\n                        </svg>\n                        <span>\u590d\u5236</span>\n                    </button>\n                    <div class=\"input-stats\">\n                        <span id=\"charCount\">0 \u5b57\u7b26</span>\n                        <div class=\"example-group\">\n                            <button class=\"example-btn\" id=\"exampleBtn\" title=\"\u586b\u5145\u793a\u4f8b\">\n                                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                    <path\n                                        d=\"M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83\" />\n                                </svg>\n                                <span>\u793a\u4f8b</span>\n                            </button>\n                            <div class=\"example-dropdown\" id=\"exampleDropdown\">\n                                <button data-size=\"small\">\u5c0f\u56fe\u793a\u4f8b (\u51e0KB)</button>\n                                <button data-size=\"medium\">10MB \u538b\u529b\u6d4b\u8bd5</button>\n                                <button data-size=\"large\">100MB \u6781\u9650\u6d4b\u8bd5</button>\n                            </div>\n                        </div>\n                        <button class=\"clear-btn\" id=\"clearBtn\" title=\"\u6e05\u7a7a\">\n                            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n                                <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n                            </svg>\n                        </button>\n                    </div>\n                </div>\n\n                <!-- \u8f6c\u6362\u6309\u94ae -->\n                <button class=\"convert-btn\" id=\"convertBtn\">\n                    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                        <polyline points=\"23 4 23 10 17 10\" />\n                        <path d=\"M20.49 15a9 9 0 1 1-2.12-9.36L23 10\" />\n                    </svg>\n                    <span id=\"convertBtnText\">\u5f00\u59cb\u8f6c\u6362</span>\n                </button>\n\n                <!-- \u8fdb\u5ea6\u6761 -->\n                <div class=\"progress-container\" id=\"progressContainer\">\n                    <div class=\"progress-header\">\n                        <span class=\"progress-label\" id=\"progressLabel\">\u51c6\u5907\u4e2d...</span>\n                        <span class=\"progress-percent\" id=\"progressPercent\">0%</span>\n                    </div>\n                    <div class=\"progress-bar\">\n                        <div class=\"progress-fill\" id=\"progressFill\"></div>\n                    </div>\n                </div>\n            </section>\n\n            <!-- \u53f3\u4fa7\u9884\u89c8\u533a -->\n            <section class=\"preview-section\">\n                <!-- \u7a7a\u72b6\u6001 -->\n                <div class=\"empty-state\" id=\"emptyState\">\n                    <div class=\"empty-icon\">\n                        <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\">\n                            <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" />\n                            <circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\" />\n                            <path d=\"M21 15l-5-5L5 21\" />\n                        </svg>\n                    </div>\n                    <h3>\u7b49\u5f85\u8f6c\u6362</h3>\n                    <p>\u8f93\u5165 Base64 \u4ee3\u7801\u6216\u62d6\u62fd\u6587\u4ef6\u5f00\u59cb\u8f6c\u6362</p>\n                </div>\n\n                <!-- \u56fe\u50cf\u9884\u89c8 -->\n                <div class=\"preview-wrapper\" id=\"previewWrapper\" style=\"display: none;\">\n                    <div class=\"preview-canvas-container\">\n                        <img id=\"previewImage\" class=\"preview-image\" alt=\"\u9884\u89c8\u56fe\u50cf\">\n                        <div class=\"image-overlay\">\n                            <button class=\"overlay-btn zoom-btn\" id=\"zoomBtn\" title=\"\u653e\u5927\u67e5\u770b\">\n                                <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                    <circle cx=\"11\" cy=\"11\" r=\"8\" />\n                                    <line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\" />\n                                    <line x1=\"11\" y1=\"8\" x2=\"11\" y2=\"14\" />\n                                    <line x1=\"8\" y1=\"11\" x2=\"14\" y2=\"11\" />\n                                </svg>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- \u56fe\u50cf\u4fe1\u606f\u9762\u677f -->\n                <div class=\"info-panel\" id=\"infoPanel\" style=\"display: none;\">\n                    <h4>\u56fe\u50cf\u4fe1\u606f</h4>\n                    <div class=\"info-grid\">\n                        <div class=\"info-item\">\n                            <span class=\"info-label\">\u5c3a\u5bf8</span>\n                            <span class=\"info-value\" id=\"infoSize\">-</span>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"info-label\">\u5bbd\u9ad8\u6bd4</span>\n                            <span class=\"info-value\" id=\"infoRatio\">-</span>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"info-label\">\u683c\u5f0f</span>\n                            <span class=\"info-value\" id=\"infoFormat\">-</span>\n                        </div>\n                        <div class=\"info-item\">\n                            <span class=\"info-label\">\u6587\u4ef6\u5927\u5c0f</span>\n                            <span class=\"info-value\" id=\"infoFileSize\">-</span>\n                        </div>\n                    </div>\n\n                    <!-- \u683c\u5f0f\u9009\u62e9\u548c\u4e0b\u8f7d -->\n                    <div class=\"download-section\">\n                        <div class=\"format-selector\">\n                            <label class=\"format-label\">\u5bfc\u51fa\u683c\u5f0f</label>\n                            <select id=\"formatSelect\" class=\"format-select\">\n                                <option value=\"original\">\u539f\u59cb\u683c\u5f0f\uff08\u65e0\u635f\uff09</option>\n                                <option value=\"image/png\">PNG\uff08\u65e0\u635f\uff0c\u652f\u6301\u900f\u660e\uff09</option>\n                                <option value=\"image/webp-lossless\">WebP \u65e0\u635f\uff08\u4f53\u79ef\u66f4\u5c0f\uff09</option>\n                                <option value=\"image/webp\">WebP \u6709\u635f\uff08\u9ad8\u8d28\u91cf\uff09</option>\n                                <option value=\"image/jpeg\">JPEG\uff08\u6709\u635f\uff0c\u4e0d\u652f\u6301\u900f\u660e\uff09</option>\n                                <option value=\"image/bmp\">BMP\uff08\u65e0\u635f\uff0c\u4f53\u79ef\u5927\uff09</option>\n                                <option value=\"image/x-icon\">ICO \u56fe\u6807 (32x32)</option>\n                                <option value=\"image/svg+xml\">SVG \u77e2\u91cf (\u539f\u6837\u5bfc\u51fa)</option>\n                            </select>\n                        </div>\n\n                        <!-- \u683c\u5f0f\u8bf4\u660e -->\n                        <div class=\"format-info\" id=\"formatInfo\">\n                            <span class=\"format-info-icon\">\u2139</span>\n                            <span class=\"format-info-text\" id=\"formatInfoText\">\u4fdd\u6301\u539f\u59cb\u56fe\u50cf\u683c\u5f0f\u548c\u8d28\u91cf\uff0c\u5b8c\u5168\u65e0\u635f\u5bfc\u51fa</span>\n                        </div>\n\n                        <button class=\"download-btn\" id=\"downloadBtn\">\n                            <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                                <path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\" />\n                                <polyline points=\"7 10 12 15 17 10\" />\n                                <line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\" />\n                            </svg>\n                            <span>\u4e0b\u8f7d\u56fe\u50cf</span>\n                        </button>\n                    </div>\n                </div>\n            </section>\n        </main>\n\n        <!-- \u72b6\u6001\u63d0\u793a -->\n        <div class=\"toast\" id=\"toast\">\n            <span class=\"toast-message\" id=\"toastMessage\"></span>\n        </div>\n\n        <!-- \u653e\u5927\u5f39\u7a97 -->\n        <div class=\"modal\" id=\"zoomModal\">\n            <div class=\"modal-backdrop\" id=\"modalBackdrop\"></div>\n            <div class=\"modal-content\">\n                <button class=\"modal-close\" id=\"modalClose\">\n                    <svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                        <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" />\n                        <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" />\n                    </svg>\n                </button>\n                <img id=\"zoomImage\" class=\"zoom-image\" alt=\"\u653e\u5927\u56fe\u50cf\">\n            </div>\n        </div>\n    </div>\n\n    \n    <script>\n        // Setup Worker Blob\n        const workerContent = \"/**\\n * Base64 \\u56fe\\u50cf\\u8f6c\\u6362\\u5668 - Web Worker (\\u589e\\u5f3a\\u7248)\\n * \\u652f\\u6301\\u5206\\u5757\\u8fdb\\u5ea6\\u6c47\\u62a5\\u3001\\u5168\\u683c\\u5f0f\\u5904\\u7406\\n */\\n\\nself.onmessage = async function (e) {\\n    const { action, data, options } = e.data;\\n\\n    try {\\n        switch (action) {\\n            case 'extractBase64':\\n                handleExtractBase64(data);\\n                break;\\n            case 'generateLargeSample':\\n                handleGenerateLargeSample(data);\\n                break;\\n            case 'convertToBase64':\\n                handleConvertToBase64(data);\\n                break;\\n            default:\\n                self.postMessage({ error: '\\u672a\\u77e5\\u64cd\\u4f5c: ' + action });\\n        }\\n    } catch (error) {\\n        self.postMessage({ error: error.message });\\n    }\\n};\\n\\n/**\\n * \\u63d0\\u53d6 Base64 \\u6570\\u636e (\\u5e26\\u8fdb\\u5ea6)\\n */\\nfunction handleExtractBase64(text) {\\n    const startTime = performance.now();\\n    const totalLen = text.length;\\n\\n    // \\u8fdb\\u5ea6\\u6c47\\u62a5\\u51fd\\u6570\\n    const report = (p, label) => self.postMessage({ action: 'progress', percent: p, label });\\n\\n    report(5, '\\u6b63\\u5728\\u6e05\\u7406\\u767d\\u540d\\u5355\\u5b57\\u7b26...');\\n    // \\u7531\\u4e8e\\u6b63\\u5219\\u5339\\u914d\\u5927\\u6587\\u4ef6\\u6bd4\\u8f83\\u8017\\u65f6\\u4e14\\u96be\\u4ee5\\u5207\\u5206\\u8fdb\\u5ea6\\uff0c\\u6211\\u4eec\\u91c7\\u7528\\u5206\\u6bb5\\u5339\\u914d\\u601d\\u8def\\n    // \\u8fd9\\u91cc\\u7b80\\u5316\\u5904\\u7406\\uff1a\\u9488\\u5bf9\\u6781\\u5927\\u578b\\u6587\\u4ef6\\uff0c\\u5148\\u505a\\u4e00\\u6b21\\u6b63\\u5219\\n\\n    const mimeTypes = {\\n        '/9j/': 'image/jpeg',\\n        'iVBORw': 'image/png',\\n        'R0lGOD': 'image/gif',\\n        'UklGR': 'image/webp',\\n        'PHN2Zz': 'image/svg+xml',\\n        'Qk02': 'image/bmp',\\n        'AAABAA': 'image/x-icon'\\n    };\\n\\n    const patterns = [\\n        { name: 'Data URI', regex: /data:image\\\\/([a-zA-Z0-9+.-]+);base64,([A-Za-z0-9+/=]{20,})/g },\\n        { name: 'HTML img', regex: /<img[^>]+src\\\\s*=\\\\s*[\\\"']data:image\\\\/([a-zA-Z0-9+.-]+);base64,([A-Za-z0-9+/=]{20,})[\\\"'][^>]*>/gi },\\n        { name: 'CSS url', regex: /url\\\\s*\\\\(\\\\s*[\\\"']?data:image\\\\/([a-zA-Z0-9+.-]+);base64,([A-Za-z0-9+/=]{20,})[\\\"']?\\\\s*\\\\)/gi }\\n    ];\\n\\n    let results = [];\\n\\n    // \\u6a21\\u62df\\u8fdb\\u5ea6 (\\u56e0\\u4e3a\\u6b63\\u5219 exec \\u65e0\\u6cd5\\u76f4\\u63a5\\u83b7\\u53d6\\u4e2d\\u95f4\\u8fdb\\u5ea6\\uff0c\\u6211\\u4eec\\u5206\\u6a21\\u5f0f\\u6c47\\u62a5)\\n    for (let i = 0; i < patterns.length; i++) {\\n        const pattern = patterns[i];\\n        report(10 + (i * 20), `\\u6b63\\u5728\\u5339\\u914d ${pattern.name} \\u6a21\\u5f0f...`);\\n\\n        const regex = new RegExp(pattern.regex.source, pattern.regex.flags);\\n        let match;\\n        while ((match = regex.exec(text)) !== null) {\\n            results.push({\\n                base64: match[2].replace(/[\\\\s\\\\r\\\\n]/g, ''),\\n                mimeType: `image/${match[1]}`,\\n                source: pattern.name\\n            });\\n        }\\n    }\\n\\n    if (results.length === 0) {\\n        report(80, '\\u5c1d\\u8bd5\\u7eaf\\u5185\\u5bb9\\u89e3\\u6790...');\\n        const cleaned = text.replace(/[\\\\s\\\\r\\\\n]/g, '');\\n        if (/^[A-Za-z0-9+/=]+$/.test(cleaned) && cleaned.length > 20) {\\n            let mime = 'image/png';\\n            for (const [prefix, m] of Object.entries(mimeTypes)) {\\n                if (cleaned.startsWith(prefix)) { mime = m; break; }\\n            }\\n            results.push({ base64: cleaned, mimeType: mime, source: '\\u7eaf\\u5185\\u5bb9' });\\n        }\\n    }\\n\\n    report(100, '\\u63d0\\u53d6\\u5b8c\\u6210');\\n    const endTime = performance.now();\\n    self.postMessage({\\n        action: 'extractBase64Result',\\n        results,\\n        performance: { time: endTime - startTime, size: text.length }\\n    });\\n}\\n\\n/**\\n * \\u5206\\u5757\\u751f\\u6210\\u5927\\u6570\\u636e (\\u5e26\\u7cbe\\u51c6\\u767e\\u5206\\u6bd4)\\n */\\nfunction handleGenerateLargeSample(sizeMB) {\\n    const startTime = performance.now();\\n    const targetLength = sizeMB * 1024 * 1024;\\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\\n\\n    let result = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\\n    const chunkSize = 512 * 1024; // \\u6bcf\\u6b21\\u751f\\u6210 0.5MB\\n    const totalChunks = Math.ceil(targetLength / chunkSize);\\n\\n    // \\u9884\\u751f\\u6210\\u4e00\\u4e2a chunk \\u6a21\\u677f\\n    let chunkTemplate = '';\\n    for (let i = 0; i < chunkSize; i++) {\\n        chunkTemplate += chars.charAt(Math.floor(Math.random() * chars.length));\\n    }\\n\\n    for (let i = 0; i < totalChunks; i++) {\\n        result += chunkTemplate;\\n        // \\u6bcf 4 \\u4e2a chunk \\u6c47\\u62a5\\u4e00\\u6b21\\u8fdb\\u5ea6\\n        if (i % 4 === 0 || i === totalChunks - 1) {\\n            self.postMessage({\\n                action: 'progress',\\n                percent: Math.round((i / totalChunks) * 100),\\n                label: `\\u6b63\\u5728\\u751f\\u6210\\u6570\\u636e: ${((i * chunkSize) / (1024 * 1024)).toFixed(1)}MB / ${sizeMB}MB`\\n            });\\n        }\\n    }\\n\\n    const endTime = performance.now();\\n    self.postMessage({\\n        action: 'generateLargeSampleResult',\\n        base64: result.substring(0, targetLength + 40),\\n        performance: { time: endTime - startTime, size: result.length }\\n    });\\n}\\n\\n/**\\n * \\u56fe\\u50cf\\u8f6c Base64 (\\u5e26\\u767e\\u5206\\u6bd4)\\n */\\nfunction handleConvertToBase64(file) {\\n    const startTime = performance.now();\\n\\n    try {\\n        const reader = new FileReaderSync();\\n        const dataUrl = reader.readAsDataURL(file);\\n        const base64 = dataUrl.split(',')[1];\\n        const endTime = performance.now();\\n\\n        self.postMessage({\\n            action: 'convertToBase64Result',\\n            base64: base64,\\n            performance: { time: endTime - startTime, size: file.size }\\n        });\\n    } catch (e) {\\n        self.postMessage({ error: 'Conversion failed: ' + e.message });\\n    }\\n}\\n\";\n        const blob = new Blob([workerContent], {type: 'application/javascript'});\n        window.WORKER_URL = URL.createObjectURL(blob);\n    </script>\n    <script>\n        // App Logic\n/**\n * Base64 \u56fe\u50cf\u8f6c\u6362\u5668 - \u6838\u5fc3\u903b\u8f91 (\u9ad8\u6027\u80fd\u7248)\n * \u652f\u6301 Web Worker \u540e\u53f0\u5904\u7406\u3001\u53cc\u5411\u4e92\u8f6c\u3001\u6027\u80fd\u76d1\u63a7\n */\n\n// ========================================\n// \u5168\u5c40\u72b6\u6001\n// ========================================\nconst state = {\n    currentImageData: null, // Data URL or Base64 string\n    currentMimeType: null,\n    currentFileName: null,\n    isProcessing: false,\n    mode: 'b2i', // 'b2i' (Base64 to Image) or 'i2b' (Image to Base64)\n    worker: null\n};\n\n// ========================================\n// DOM \u5143\u7d20\n// ========================================\nconst elements = {\n    perfBanner: document.getElementById('perfBanner'),\n    perfSize: document.getElementById('perfSize'),\n    perfTime: document.getElementById('perfTime'),\n    perfSpeed: document.getElementById('perfSpeed'),\n    modeTabs: document.querySelectorAll('.mode-tab'),\n    dropZone: document.getElementById('dropZone'),\n    dropTitle: document.getElementById('dropTitle'),\n    dropDesc: document.getElementById('dropDesc'),\n    fileInput: document.getElementById('fileInput'),\n    base64Input: document.getElementById('base64Input'),\n    copyBtn: document.getElementById('copyBtn'),\n    charCount: document.getElementById('charCount'),\n    exampleBtn: document.getElementById('exampleBtn'),\n    exampleDropdown: document.getElementById('exampleDropdown'),\n    exampleSizeBtns: document.querySelectorAll('#exampleDropdown button'),\n    clearBtn: document.getElementById('clearBtn'),\n    convertBtn: document.getElementById('convertBtn'),\n    convertBtnText: document.getElementById('convertBtnText'),\n    progressContainer: document.getElementById('progressContainer'),\n    progressLabel: document.getElementById('progressLabel'),\n    progressPercent: document.getElementById('progressPercent'),\n    progressFill: document.getElementById('progressFill'),\n    emptyState: document.getElementById('emptyState'),\n    previewWrapper: document.getElementById('previewWrapper'),\n    previewImage: document.getElementById('previewImage'),\n    infoPanel: document.getElementById('infoPanel'),\n    infoSize: document.getElementById('infoSize'),\n    infoRatio: document.getElementById('infoRatio'),\n    infoFormat: document.getElementById('infoFormat'),\n    infoFileSize: document.getElementById('infoFileSize'),\n    formatSelect: document.getElementById('formatSelect'),\n    formatInfo: document.getElementById('formatInfo'),\n    formatInfoText: document.getElementById('formatInfoText'),\n    downloadBtn: document.getElementById('downloadBtn'),\n    toast: document.getElementById('toast'),\n    toastMessage: document.getElementById('toastMessage'),\n    zoomBtn: document.getElementById('zoomBtn'),\n    zoomModal: document.getElementById('zoomModal'),\n    modalBackdrop: document.getElementById('modalBackdrop'),\n    modalClose: document.getElementById('modalClose'),\n    zoomImage: document.getElementById('zoomImage')\n};\n\n// ========================================\n// Worker \u7ba1\u7406\u5668\n// ========================================\nconst WorkerManager = {\n    init() {\n        // \u68c0\u67e5\u534f\u8bae\n        if (window.location.protocol === 'file:') {\n            console.warn('\u68c0\u6d4b\u5230\u672c\u5730\u6587\u4ef6\u534f\u8bae\uff0c\u67d0\u4e9b\u6d4f\u89c8\u5668\u53ef\u80fd\u4f1a\u7981\u7528 Web Worker');\n            UIController.showToast('\u672c\u5730\u6a21\u5f0f\u8fd0\u884c\uff1a\u5927\u6587\u4ef6\u5904\u7406\u53ef\u80fd\u53d7\u963b', 'warning');\n        }\n\n        if (window.Worker) {\n            try {\n                state.worker = new Worker(window.WORKER_URL);\n                state.worker.onmessage = this.handleMessage.bind(this);\n                state.worker.onerror = (err) => {\n                    console.error('Worker \u521d\u59cb\u5316\u5931\u8d25:', err);\n                    UIController.showToast('Web Worker \u542f\u52a8\u5931\u8d25 (\u53ef\u80fd\u662f\u534f\u8bae\u9650\u5236)', 'error');\n                };\n            } catch (e) {\n                UIController.showToast('Web Worker \u521d\u59cb\u5316\u5f02\u5e38', 'error');\n            }\n        } else {\n            UIController.showToast('\u6d4f\u89c8\u5668\u4e0d\u652f\u6301 Web Worker', 'warning');\n        }\n    },\n\n    handleMessage(e) {\n        const { action, results, base64, size, performance: perf, error, percent, label } = e.data;\n\n        if (error) {\n            UIController.showToast('\u5904\u7406\u51fa\u9519: ' + error, 'error');\n            UIController.setProcessing(false);\n            UIController.showProgress(false);\n            return;\n        }\n\n        switch (action) {\n            case 'progress':\n                UIController.updateProgress(percent, label);\n                break;\n            case 'extractBase64Result':\n                handleConverterResult(results, perf);\n                break;\n            case 'generateLargeSampleResult':\n                handleSampleResult(base64, perf);\n                break;\n            case 'convertToBase64Result':\n                handleImageToB64Result(base64, perf);\n                break;\n        }\n    },\n\n    post(action, data, options) {\n        if (state.worker) {\n            state.worker.postMessage({ action, data, options });\n        } else {\n            UIController.showToast('\u540e\u53f0\u7ebf\u7a0b\u672a\u5c31\u7eea', 'error');\n        }\n    }\n};\n\n// ========================================\n// UI \u63a7\u5236\u5668\n// ========================================\nconst UIController = {\n    showProgress(show) {\n        elements.progressContainer.classList.toggle('show', show);\n    },\n\n    updateProgress(percent, label) {\n        elements.progressFill.style.width = percent + '%';\n        elements.progressPercent.textContent = Math.round(percent) + '%';\n        if (label) elements.progressLabel.textContent = label;\n    },\n\n    showPerf(perf) {\n        if (!perf) {\n            elements.perfBanner.style.display = 'none';\n            return;\n        }\n        elements.perfBanner.style.display = 'flex';\n        elements.perfSize.textContent = `\u8ba1\u7b97\u5927\u5c0f: ${ImageProcessor.formatFileSize(perf.size || 0)}`;\n        elements.perfTime.textContent = `\u603b\u8017\u65f6: ${(perf.time / 1000).toFixed(3)}s`;\n\n        const speed = (perf.size / (1024 * 1024)) / (perf.time / 1000);\n        elements.perfSpeed.textContent = `\u901f\u7387: ${speed.toFixed(1)} MB/s`;\n    },\n\n    switchMode(mode) {\n        state.mode = mode;\n        elements.modeTabs.forEach(tab => tab.classList.toggle('active', tab.dataset.mode === mode));\n\n        const isB2I = mode === 'b2i';\n        elements.dropTitle.textContent = isB2I ? '\u62d6\u62fd\u6587\u4ef6\u5230\u6b64\u5904' : '\u62d6\u62fd\u56fe\u50cf\u5230\u6b64\u5904';\n        elements.dropDesc.textContent = isB2I ? '\u652f\u6301\u6587\u672c\u3001\u4ee3\u7801\u7b49\u5305\u542b Base64 \u7684\u6587\u4ef6' : '\u652f\u6301\u5404\u79cd\u5e38\u89c1\u56fe\u50cf\u683c\u5f0f';\n        elements.base64Input.placeholder = isB2I ? '\u5728\u6b64\u7c98\u8d34 Base64 \u4ee3\u7801...' : '\u8fd9\u91cc\u5c06\u663e\u793a\u751f\u6210\u7684 Base64 \u4ee3\u7801...';\n        elements.convertBtnText.textContent = isB2I ? '\u5f00\u59cb\u8f6c\u6362' : '\u751f\u6210 Base64';\n\n        this.hidePreview();\n        this.showPerf(null);\n        elements.base64Input.value = '';\n        elements.charCount.textContent = '0 \u5b57\u7b26';\n    },\n\n    showPreview(dataUrl, info, mimeType, fileSize) {\n        elements.emptyState.style.display = 'none';\n        elements.previewWrapper.style.display = 'flex';\n        elements.infoPanel.style.display = 'block';\n        elements.previewImage.src = dataUrl;\n        elements.zoomImage.src = dataUrl;\n\n        elements.infoSize.textContent = `${info.width} \u00d7 ${info.height} px`;\n        elements.infoRatio.textContent = info.ratioText;\n        elements.infoFormat.textContent = ImageProcessor.getFormatName(mimeType);\n        elements.infoFileSize.textContent = ImageProcessor.formatFileSize(fileSize);\n    },\n\n    hidePreview() {\n        elements.emptyState.style.display = 'flex';\n        elements.previewWrapper.style.display = 'none';\n        elements.infoPanel.style.display = 'none';\n    },\n\n    showToast(message, type = 'info') {\n        elements.toastMessage.textContent = message;\n        elements.toast.className = 'toast show ' + type;\n        setTimeout(() => elements.toast.classList.remove('show'), 3000);\n    },\n\n    setProcessing(processing) {\n        state.isProcessing = processing;\n        elements.convertBtn.disabled = processing;\n        elements.convertBtn.classList.toggle('spinning', processing);\n    }\n};\n\n// ========================================\n// \u4e1a\u52a1\u903b\u8f91\u5904\u7406\n// ========================================\n\n// \u5904\u7406\u63d0\u53d6\u7ed3\u679c\nasync function handleConverterResult(results, perf) {\n    if (!results || results.length === 0) {\n        UIController.showToast('\u672a\u68c0\u6d4b\u5230\u6709\u6548\u7684 Base64 \u6570\u636e', 'error');\n        UIController.setProcessing(false);\n        UIController.showProgress(false);\n        return;\n    }\n\n    const res = results[0];\n    const dataUrl = `data:${res.mimeType};base64,${res.base64}`;\n\n    try {\n        const info = await ImageProcessor.getImageInfo(dataUrl);\n        state.currentImageData = dataUrl;\n        state.currentMimeType = res.mimeType;\n        state.currentFileName = `export_${Date.now()}.${ImageProcessor.getExtension(res.mimeType)}`;\n\n        UIController.showPreview(dataUrl, info, res.mimeType, res.base64.length * 0.75);\n        UIController.showPerf({ ...perf, size: res.base64.length });\n        UIController.showToast(`\u8bc6\u522b\u6210\u529f (${res.source})`, 'success');\n    } catch (e) {\n        UIController.showToast('\u56fe\u50cf\u6e32\u67d3\u5931\u8d25', 'error');\n    }\n\n    UIController.setProcessing(false);\n    UIController.showProgress(false);\n}\n\n// \u5904\u7406\u793a\u4f8b\u7ed3\u679c\nfunction handleSampleResult(base64, perf) {\n    elements.base64Input.value = base64;\n    elements.charCount.textContent = formatNumber(base64.length) + ' \u5b57\u7b26';\n    UIController.setProcessing(false);\n    UIController.showProgress(false);\n    UIController.showToast(`\u793a\u4f8b\u6570\u636e\u5df2\u751f\u6210 (${ImageProcessor.formatFileSize(base64.length)})`, 'success');\n}\n\n// \u5904\u7406\u56fe\u50cf\u8f6c Base64 \u7ed3\u679c\nfunction handleImageToB64Result(base64, perf) {\n    elements.base64Input.value = `data:${state.currentMimeType};base64,${base64}`;\n    elements.charCount.textContent = formatNumber(elements.base64Input.value.length) + ' \u5b57\u7b26';\n    UIController.showPerf(perf);\n    UIController.setProcessing(false);\n    UIController.showProgress(false);\n    UIController.showToast('Base64 \u751f\u6210\u5b8c\u6bd5', 'success');\n}\n\n// ========================================\n// \u6838\u5fc3\u903b\u8f91\u96c6\u6210\n// ========================================\n\nconst ImageProcessor = {\n    getImageInfo(dataUrl) {\n        return new Promise((resolve, reject) => {\n            const img = new Image();\n            img.onload = () => {\n                const w = img.naturalWidth, h = img.naturalHeight;\n                const gcd = (a, b) => b === 0 ? a : gcd(b, a % b);\n                const d = gcd(w, h);\n                resolve({ width: w, height: h, ratioText: `${w / d}:${h / d}` });\n            };\n            img.onerror = () => reject();\n            img.src = dataUrl;\n        });\n    },\n    formatFileSize(b) {\n        if (b < 1024) return b + ' B';\n        if (b < 1048576) return (b / 1024).toFixed(2) + ' KB';\n        return (b / 1048576).toFixed(2) + ' MB';\n    },\n    getFormatName(m) {\n        const names = {\n            'image/jpeg': 'JPEG',\n            'image/png': 'PNG',\n            'image/gif': 'GIF',\n            'image/webp': 'WebP',\n            'image/svg+xml': 'SVG \u77e2\u91cf',\n            'image/bmp': 'BMP',\n            'image/x-icon': 'ICO \u56fe\u6807'\n        };\n        return names[m] || m.split('/')[1]?.toUpperCase() || 'IMG';\n    },\n    getExtension(m) {\n        const exts = {\n            'image/jpeg': 'jpg',\n            'image/png': 'png',\n            'image/gif': 'gif',\n            'image/webp': 'webp',\n            'image/svg+xml': 'svg',\n            'image/bmp': 'bmp',\n            'image/x-icon': 'ico'\n        };\n        return exts[m] || 'png';\n    }\n};\n\n// ========================================\n// \u4e8b\u4ef6\u7ed1\u5b9a\n// ========================================\nfunction init() {\n    WorkerManager.init();\n\n    // \u6a21\u5f0f\u5207\u6362\n    elements.modeTabs.forEach(tab => {\n        tab.addEventListener('click', () => UIController.switchMode(tab.dataset.mode));\n    });\n\n    // \u793a\u4f8b\u6309\u94ae\n    elements.exampleBtn.addEventListener('click', (e) => {\n        e.stopPropagation();\n        elements.exampleDropdown.classList.toggle('show');\n    });\n\n    document.addEventListener('click', () => elements.exampleDropdown.classList.remove('show'));\n\n    elements.exampleSizeBtns.forEach(btn => {\n        btn.addEventListener('click', () => {\n            const size = btn.dataset.size;\n            UIController.setProcessing(true);\n            UIController.showProgress(true);\n            UIController.updateProgress(50, '\u6b63\u5728\u751f\u6210\u6a21\u62df\u6570\u636e...');\n\n            if (size === 'small') {\n                handleSampleResult(`data:image/webp;base64,UklGRmYBAABXRUJQVlA4IFoBAABwCwCdASoQABAAAwA6JQBOuAD7I97AAAD+/v38jD8p6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O6O57f79ff73/f3++/33xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF73xe98XvfF7/A9f/mYAAAGS/qNfv9f7+p/qX6S/qS/qNfv9f7+YAAA`, { time: 10, size: 200 });\n            } else {\n                const mb = size === 'medium' ? 10 : 100;\n                WorkerManager.post('generateLargeSample', mb);\n            }\n        });\n    });\n\n    // \u6587\u4ef6\u5904\u7406\n    const handleFile = async (file) => {\n        if (state.mode === 'b2i') {\n            const reader = new FileReader();\n            reader.onload = (e) => {\n                if (file.size < 2 * 1024 * 1024) { // < 2MB \u5219\u663e\u793a\u5728\u6846\u91cc\n                    elements.base64Input.value = e.target.result;\n                    elements.charCount.textContent = formatNumber(e.target.result.length) + ' \u5b57\u7b26';\n                }\n                WorkerManager.post('extractBase64', e.target.result);\n            };\n            reader.readAsText(file);\n        } else {\n            state.currentMimeType = file.type;\n            WorkerManager.post('convertToBase64', file);\n        }\n        UIController.setProcessing(true);\n        UIController.showProgress(true);\n        UIController.updateProgress(50, '\u540e\u53f0\u5904\u7406\u4e2d...');\n    };\n\n    elements.dropZone.addEventListener('click', () => elements.fileInput.click());\n    elements.fileInput.addEventListener('change', (e) => e.target.files[0] && handleFile(e.target.files[0]));\n    elements.dropZone.addEventListener('dragover', (e) => { e.preventDefault(); elements.dropZone.classList.add('drag-over'); });\n    elements.dropZone.addEventListener('dragleave', () => elements.dropZone.classList.remove('drag-over'));\n    elements.dropZone.addEventListener('drop', (e) => {\n        e.preventDefault();\n        elements.dropZone.classList.remove('drag-over');\n        if (e.dataTransfer.files[0]) handleFile(e.dataTransfer.files[0]);\n    });\n\n    // \u8f6c\u6362\u6309\u94ae\n    elements.convertBtn.addEventListener('click', () => {\n        const val = elements.base64Input.value.trim();\n        if (!val) return UIController.showToast('\u8bf7\u8f93\u5165\u5185\u5bb9', 'error');\n\n        UIController.setProcessing(true);\n        UIController.showProgress(true);\n        UIController.updateProgress(50, '\u5904\u7406\u4e2d...');\n\n        if (state.mode === 'b2i') {\n            WorkerManager.post('extractBase64', val);\n        } else {\n            // \u56fe\u7247\u8f6c Base64 \u903b\u8f91\u5df2\u5728 handleFile \u4e2d\u5904\u7406 ArrayBuffer\n            // \u5982\u679c\u662f\u624b\u52a8\u7c98\u8d34 URL (\u8f83\u5c11\u89c1)\uff0c\u6b64\u5904\u6682\u4e0d\u5904\u7406\u590d\u6742\u89e3\u6790\n            UIController.showToast('\u8bf7\u76f4\u63a5\u4e0a\u4f20\u56fe\u50cf\u6587\u4ef6', 'info');\n            UIController.setProcessing(false);\n            UIController.showProgress(false);\n        }\n    });\n\n    // \u6e05\u7a7a\n    elements.clearBtn.addEventListener('click', () => {\n        elements.base64Input.value = '';\n        elements.charCount.textContent = '0 \u5b57\u7b26';\n        UIController.hidePreview();\n        UIController.showPerf(null);\n    });\n\n    // \u5b57\u6570\u7edf\u8ba1\n    elements.base64Input.addEventListener('input', () => {\n        elements.charCount.textContent = formatNumber(elements.base64Input.value.length) + ' \u5b57\u7b26';\n    });\n\n    // \u5f39\u7a97\n    elements.zoomBtn.addEventListener('click', () => {\n        elements.zoomImage.src = state.currentImageData;\n        elements.zoomModal.classList.add('show');\n    });\n    elements.modalClose.addEventListener('click', () => elements.zoomModal.classList.remove('show'));\n    elements.modalBackdrop.addEventListener('click', () => elements.zoomModal.classList.remove('show'));\n\n    // \u590d\u5236\u6309\u94ae\n    elements.copyBtn.addEventListener('click', async () => {\n        const text = elements.base64Input.value;\n        if (!text) return UIController.showToast('\u6ca1\u6709\u53ef\u590d\u5236\u7684\u5185\u5bb9', 'info');\n\n        try {\n            await navigator.clipboard.writeText(text);\n            UIController.showToast('\u5185\u5bb9\u5df2\u590d\u5236\u5230\u526a\u8d34\u677f\uff01', 'success');\n        } catch (err) {\n            // Fallback for older browsers\n            elements.base64Input.select();\n            document.execCommand('copy');\n            UIController.showToast('\u5df2\u9009\u4e2d\u5e76\u590d\u5236', 'success');\n        }\n    });\n\n    // \u4e0b\u8f7d\u529f\u80fd\n    elements.downloadBtn.addEventListener('click', async () => {\n        if (!state.currentImageData) return;\n\n        const targetFormat = elements.formatSelect.value;\n        let downloadUrl = state.currentImageData;\n        let fileName = state.currentFileName;\n\n        if (targetFormat !== 'original' && targetFormat !== state.currentMimeType) {\n            UIController.showToast('\u6b63\u5728\u8f6c\u6362\u683c\u5f0f...', 'info');\n            try {\n                const result = await convertImageFormat(state.currentImageData, targetFormat);\n                downloadUrl = result.dataUrl;\n                fileName = `export_${Date.now()}.${ImageProcessor.getExtension(targetFormat)}`;\n            } catch (e) {\n                UIController.showToast('\u683c\u5f0f\u8f6c\u6362\u5931\u8d25\uff0c\u5c06\u6309\u539f\u56fe\u4e0b\u8f7d', 'warning');\n            }\n        }\n\n        const link = document.createElement('a');\n        link.href = downloadUrl;\n        link.download = fileName;\n        link.click();\n    });\n}\n\n// \u683c\u5f0f\u8f6c\u6362\u903b\u8f91 (\u4e3b\u7ebf\u7a0b Canvas)\nfunction convertImageFormat(dataUrl, targetFormat) {\n    return new Promise((resolve, reject) => {\n        const img = new Image();\n        img.onload = () => {\n            const canvas = document.createElement('canvas');\n            // \u5bf9\u4e8e ICO\uff0c\u5f3a\u5236 32x32\uff0c\u5426\u5219\u6309\u539f\u56fe\n            if (targetFormat === 'image/x-icon') {\n                canvas.width = 32;\n                canvas.height = 32;\n            } else {\n                canvas.width = img.naturalWidth;\n                canvas.height = img.naturalHeight;\n            }\n\n            const ctx = canvas.getContext('2d');\n            if (targetFormat === 'image/jpeg') {\n                ctx.fillStyle = '#FFFFFF';\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n            }\n            ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\n            resolve({ dataUrl: canvas.toDataURL(targetFormat === 'image/x-icon' ? 'image/png' : targetFormat) });\n        };\n        img.onerror = reject;\n        img.src = dataUrl;\n    });\n}\n\nfunction formatNumber(n) { return n.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, ','); }\n\ndocument.addEventListener('DOMContentLoaded', init);\n\n    </script>\n\n</body>\n\n</html>";
        
        return new Response(html, {
            headers: {
                "content-type": "text/html;charset=UTF-8",
                "Cache-Control": "public, max-age=3600"
            },
        });
    }
};
